{{ define "invoices" }}
<div id="invoices-fragment" class="bg-gray-800 p-6 rounded-lg" hx-get="/invoices/fragment" hx-trigger="invoicesUpdated from:body" hx-swap="outerHTML">
  <input type="hidden" name="status" value="{{ .Status }}">
  <input type="hidden" name="sortBy" value="{{ .Pagination.SortBy }}">
  <input type="hidden" name="sortDir" value="{{ .Pagination.SorDir }}">
  <div class="flex justify-between items-center">
    <h3 class="flex text-lg font-semibold">{{ .Title }}</h3>

    {{ template "pagination" . }}

  </div>
  <table class="w-full mt-4 text-sm">
    <thead class="border-b border-gray-700">
      <tr>
        <th class="text-left py-2 cursor-pointer" hx-get="/invoices/fragment" hx-trigger="dblclick" hx-target="#invoices-fragment" hx-swap="outerHTML" hx-include="[name='status'], [name='pageSize'], [name='showSizeSelector'], [name='sortBy'], [name='sortDir']" hx-vals='{"sortBy":"id","sortDir":"{{ if and (eq .Pagination.SortBy "id") (eq .Pagination.SorDir "asc") }}desc{{ else }}asc{{ end }}"}'>
          Num. Factura
          {{ if eq .Pagination.SortBy "id" }}
            {{ if eq .Pagination.SorDir "asc" }}<i class="fa-solid fa-caret-up ml-1"></i>{{ else }}<i class="fa-solid fa-caret-down ml-1"></i>{{ end }}
          {{ end }}
        </th>
        <th class="text-left py-2 cursor-pointer" hx-get="/invoices/fragment" hx-trigger="dblclick" hx-target="#invoices-fragment" hx-swap="outerHTML" hx-include="[name='status'], [name='pageSize'], [name='showSizeSelector'], [name='sortBy'], [name='sortDir']" hx-vals='{"sortBy":"customer_name","sortDir":"{{ if and (eq .Pagination.SortBy "customer_name") (eq .Pagination.SorDir "asc") }}desc{{ else }}asc{{ end }}"}'>
          Cliente
          {{ if eq .Pagination.SortBy "customer_name" }}
            {{ if eq .Pagination.SorDir "asc" }}<i class="fa-solid fa-caret-up ml-1"></i>{{ else }}<i class="fa-solid fa-caret-down ml-1"></i>{{ end }}
          {{ end }}
        </th>
        <th class="text-left py-2 cursor-pointer" hx-get="/invoices/fragment" hx-trigger="dblclick" hx-target="#invoices-fragment" hx-swap="outerHTML" hx-include="[name='status'], [name='pageSize'], [name='showSizeSelector'], [name='sortBy'], [name='sortDir']" hx-vals='{"sortBy":"invoice_date","sortDir":"{{ if and (eq .Pagination.SortBy "invoice_date") (eq .Pagination.SorDir "asc") }}desc{{ else }}asc{{ end }}"}'>
          Fecha
          {{ if eq .Pagination.SortBy "invoice_date" }}
            {{ if eq .Pagination.SorDir "asc" }}<i class="fa-solid fa-caret-up ml-1"></i>{{ else }}<i class="fa-solid fa-caret-down ml-1"></i>{{ end }}
          {{ end }}
        </th>
        <th class="text-left py-2 cursor-pointer" hx-get="/invoices/fragment" hx-trigger="dblclick" hx-target="#invoices-fragment" hx-swap="outerHTML" hx-include="[name='status'], [name='pageSize'], [name='showSizeSelector'], [name='sortBy'], [name='sortDir']" hx-vals='{"sortBy":"due_date","sortDir":"{{ if and (eq .Pagination.SortBy "due_date") (eq .Pagination.SorDir "asc") }}desc{{ else }}asc{{ end }}"}'>
          Vencimiento
          {{ if eq .Pagination.SortBy "due_date" }}
            {{ if eq .Pagination.SorDir "asc" }}<i class="fa-solid fa-caret-up ml-1"></i>{{ else }}<i class="fa-solid fa-caret-down ml-1"></i>{{ end }}
          {{ end }}
        </th>
        <th class="text-left py-2 cursor-pointer" hx-get="/invoices/fragment" hx-trigger="dblclick" hx-target="#invoices-fragment" hx-swap="outerHTML" hx-include="[name='status'], [name='pageSize'], [name='showSizeSelector'], [name='sortBy'], [name='sortDir']" hx-vals='{"sortBy":"payment_mean","sortDir":"{{ if and (eq .Pagination.SortBy "payment_mean") (eq .Pagination.SorDir "asc") }}desc{{ else }}asc{{ end }}"}'>
          Medio
          {{ if eq .Pagination.SortBy "payment_mean" }}
            {{ if eq .Pagination.SorDir "asc" }}<i class="fa-solid fa-caret-up ml-1"></i>{{ else }}<i class="fa-solid fa-caret-down ml-1"></i>{{ end }}
          {{ end }}
        </th>
        <th class="text-right py-2 cursor-pointer" hx-get="/invoices/fragment" hx-trigger="dblclick" hx-target="#invoices-fragment" hx-swap="outerHTML" hx-include="[name='status'], [name='pageSize'], [name='showSizeSelector'], [name='sortBy'], [name='sortDir']" hx-vals='{"sortBy":"amount_due","sortDir":"{{ if and (eq .Pagination.SortBy "amount_due") (eq .Pagination.SorDir "asc") }}desc{{ else }}asc{{ end }}"}'>
          Cantidad
          {{ if eq .Pagination.SortBy "amount_due" }}
            {{ if eq .Pagination.SorDir "asc" }}<i class="fa-solid fa-caret-up ml-1"></i>{{ else }}<i class="fa-solid fa-caret-down ml-1"></i>{{ end }}
          {{ end }}
        </th>
        <th class="text-right py-2 cursor-pointer" hx-get="/invoices/fragment" hx-trigger="dblclick" hx-target="#invoices-fragment" hx-swap="outerHTML" hx-include="[name='status'], [name='pageSize'], [name='showSizeSelector'], [name='sortBy'], [name='sortDir']" hx-vals='{"sortBy":"total_paid","sortDir":"{{ if and (eq .Pagination.SortBy "total_paid") (eq .Pagination.SorDir "asc") }}desc{{ else }}asc{{ end }}"}'>
          Pagado
          {{ if eq .Pagination.SortBy "total_paid" }}
            {{ if eq .Pagination.SorDir "asc" }}<i class="fa-solid fa-caret-up ml-1"></i>{{ else }}<i class="fa-solid fa-caret-down ml-1"></i>{{ end }}
          {{ end }}
        </th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-700">
      {{ range .Invoices }}
      <tr class="hover:bg-gray-700 transition-colors" data-invoice-id="{{ .ID }}" data-customer-name="{{ .CustomerName }}" data-amount-due="{{ .AmountDueRaw }}" data-payment-mean="{{ .PaymentMean }}" data-invoice-date="{{ .InvoiceDate }}" data-due-date="{{ .DueDate }}">
        <td class="py-2">{{ .ID }}</td>
        <td class="py-2">{{ .CustomerName }}</td>
        <td>
          <span class="bg-gray-700 px-3 py-1 rounded-full text-xs">{{ .InvoiceDate }}</span>
        </td>
        <td>
          <span class="bg-gray-700 px-3 py-1 rounded-full text-xs">{{ .DueDate }}</span>
        </td>
        <td class="py-2">{{ .PaymentMean }}</td>
        <td class="text-right">{{ .AmountDue }}</td>
        <td class="text-right">{{ .TotalPaid }}</td>
      </tr>
      {{ end }}
    </tbody>
  </table>
</div>
{{ end }}
